{"ast":null,"code":"var _jsxFileName = \"/home/actserv/Documents/Lunyamwi_Projects/appraisal-system/appraisal-system-fend-web/src/components/admin/registerAdmin.js\";\nimport React, { useContext, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Grid, Container, Header, Tab, Form, Message, Divider } from 'semantic-ui-react';\nimport PhoneInput from \"react-phone-input-2\";\nimport gql from 'graphql-tag';\nimport { useMutation } from '@apollo/react-hooks';\nimport { AuthContext } from '../../context/auth';\nimport '../root.scss';\n\nfunction RegisterAdmin(props) {\n  const [errors, setErrors] = useState({});\n  const context = useContext(AuthContext);\n  const [values, setValues] = useState({\n    username: \"\",\n    password: \"\",\n    email: \"\",\n    firstName: \"\",\n    lastName: \"\",\n    phoneNumber: \"\"\n  });\n  const [addUser, {\n    loading\n  }] = useMutation(REGISTER_USER, {\n    update(_, result) {\n      context.registerAdmin(result.data);\n      console.log(\"response\", result.data.createAdmin.message);\n      props.history.push({\n        pathname: '/',\n        state: {\n          systemAlert: result.data.createAdmin.message\n        }\n      });\n    },\n\n    onError(err) {\n      try {\n        if (err.networkError !== null && err.networkError !== 'undefined') {\n          setErrors(err.networkError.result.errors[0]);\n        } else if (err.graphQLErrors !== null && err.networkError !== 'undefined') {\n          setErrors(err.graphQLErrors.result.errors[0]);\n        }\n      } catch (e) {\n        setErrors(err);\n      }\n    },\n\n    variables: values\n  });\n\n  const onChange = (event, {\n    name,\n    value\n  }) => {\n    setValues({ ...values,\n      [event.target.name]: event.target.value\n    });\n  };\n\n  const onPhoneNumberChange = value => {\n    setValues({ ...values,\n      phoneNumber: \"+\" + value\n    });\n  };\n\n  const onAgencyPhoneNumberChange = value => {\n    setValues({ ...values,\n      agencyPhoneNumber: \"+\" + value\n    });\n  };\n\n  const [visible, setVisible] = useState(false);\n\n  const handleDismiss = () => {\n    setVisible(false);\n  };\n\n  const onSubmit = event => {\n    event.preventDefault();\n    errors.message = \"\";\n    setVisible(true);\n    addUser();\n  };\n\n  const panes = [{\n    menuItem: 'Admin Registration',\n    render: () => /*#__PURE__*/React.createElement(Form, {\n      onSubmit: onSubmit,\n      noValidate: true,\n      className: loading ? \"loading\" : '',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Divider, {\n      horizontal: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 21\n      }\n    }, \"Personal Information\"), /*#__PURE__*/React.createElement(Form.Group, {\n      widths: \"equal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Form.Input, {\n      fluid: true,\n      label: \"Username\",\n      placeholder: \"Username\",\n      name: \"username\",\n      value: values.username,\n      onChange: onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(Form.Input, {\n      fluid: true,\n      label: \"First name\",\n      placeholder: \"First name\",\n      name: \"firstName\",\n      value: values.firstName,\n      onChange: onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(Form.Input, {\n      fluid: true,\n      label: \"Last name\",\n      placeholder: \"Last name\",\n      name: \"lastName\",\n      value: values.lastName,\n      onChange: onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 25\n      }\n    })), /*#__PURE__*/React.createElement(Form.Group, {\n      widths: \"equal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Form.Input, {\n      fluid: true,\n      label: \"Password\",\n      placeholder: \"Password\",\n      name: \"password\",\n      value: values.password,\n      onChange: onChange,\n      type: \"password\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(Form.Input, {\n      fluid: true,\n      label: \"Email\",\n      placeholder: \"Email Address\",\n      name: \"email\",\n      value: values.email,\n      onChange: onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(Form.Field, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(PhoneInput, {\n      inputExtraProps: {\n        name: \"phoneNumber\",\n        required: true,\n        autoFocus: true,\n        enableSearch: true\n      },\n      name: \"phoneNumber\",\n      specialLabel: \"Phone Number\",\n      country: \"ke\",\n      value: values.phoneNumber,\n      onChange: onPhoneNumberChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 29\n      }\n    }))), /*#__PURE__*/React.createElement(Form.Checkbox, {\n      label: \"I agree to the Terms and Conditions\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(Form.Button, {\n      secondary: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 21\n      }\n    }, \"Register Admin\"))\n  }];\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \".app-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    padded: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Grid.Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Grid.Column, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    as: \"h1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 29\n    }\n  }, \"Sign Up\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 29\n    }\n  }, \"Already got an account?\", /*#__PURE__*/React.createElement(Link, {\n    to: \"/\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 29\n    }\n  }, \" Sign In Here\")), /*#__PURE__*/React.createElement(Tab, {\n    className: \"clear-top\",\n    menu: {\n      secondary: true,\n      pointing: true\n    },\n    panes: panes,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 29\n    }\n  }), visible ? /*#__PURE__*/React.createElement(Message, {\n    onDismiss: handleDismiss,\n    header: \"System Response\",\n    content: errors ? errors.message : '',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 33\n    }\n  }) : '')))));\n}\n\nconst REGISTER_USER = gql`\nmutation createAdmin(\n    $username: String!\n    $firstName: String!\n    $lastName: String!\n    $password: String!\n    $email: String!\n    $phoneNumber: String!\n) {\n  createAdmin(\n  admin:{\n    username: $username\n    password: $password\n    email: $email\n    firstName: $firstName\n    lastName: $lastName\n    phoneNumber: $phoneNumber\n   image:\"https://res.cloudinary.com/dsw3onksq/image/upload/v1592728825/user_x89zcm.png\"\n  }\n  ){\n    status\n    message\n    admin {\n      id\n      username\n      email\n      firstName\n      isSuperuser\n      isActive\n      isStaff\n      image\n      phoneNumber\n      roles\n    }\n  }\n}\n`;\nexport default RegisterAdmin;","map":{"version":3,"sources":["/home/actserv/Documents/Lunyamwi_Projects/appraisal-system/appraisal-system-fend-web/src/components/admin/registerAdmin.js"],"names":["React","useContext","useState","Link","Grid","Container","Header","Tab","Form","Message","Divider","PhoneInput","gql","useMutation","AuthContext","RegisterAdmin","props","errors","setErrors","context","values","setValues","username","password","email","firstName","lastName","phoneNumber","addUser","loading","REGISTER_USER","update","_","result","registerAdmin","data","console","log","createAdmin","message","history","push","pathname","state","systemAlert","onError","err","networkError","graphQLErrors","e","variables","onChange","event","name","value","target","onPhoneNumberChange","onAgencyPhoneNumberChange","agencyPhoneNumber","visible","setVisible","handleDismiss","onSubmit","preventDefault","panes","menuItem","render","required","autoFocus","enableSearch","secondary","pointing"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport {\n    Grid,\n    Container,\n    Header,\n    Tab,\n    Form,\n    Message,\n    Divider,\n} from 'semantic-ui-react';\nimport PhoneInput from \"react-phone-input-2\";\nimport gql from 'graphql-tag';\nimport { useMutation } from '@apollo/react-hooks';\nimport { AuthContext } from '../../context/auth';\n\nimport '../root.scss';\n\nfunction RegisterAdmin(props) {\n    const [errors, setErrors] = useState({});\n    const context = useContext(AuthContext);\n\n    const [values, setValues] = useState({\n        username: \"\",\n        password: \"\",\n        email: \"\",\n        firstName: \"\",\n        lastName: \"\",\n        phoneNumber: \"\",\n        \n    })\n\n    const [addUser, { loading }] = useMutation(REGISTER_USER, {\n        update(_, result) {\n            context.registerAdmin(result.data);\n            console.log(\"response\", result.data.createAdmin.message);\n            props.history.push({\n                pathname: '/',\n                state: { systemAlert: result.data.createAdmin.message }\n            })\n        },\n        onError(err) {\n            try {\n\n                if (err.networkError !== null && err.networkError !== 'undefined') {\n\n                    setErrors(err.networkError.result.errors[0]);\n\n                } else if (err.graphQLErrors !== null && err.networkError !== 'undefined') {\n\n                    setErrors(err.graphQLErrors.result.errors[0]);\n\n                }\n            } catch (e) {\n                setErrors(err);\n            }\n\n        },\n        variables: values\n    });\n\n    const onChange = (event, { name, value }) => {\n        setValues({ ...values, [event.target.name]: event.target.value });\n    }\n    const onPhoneNumberChange = value => {\n        setValues({ ...values, phoneNumber: \"+\" + value });\n    }\n    const onAgencyPhoneNumberChange = value => {\n        setValues({ ...values, agencyPhoneNumber: \"+\" + value });\n    }\n\n    const [visible, setVisible] = useState(false);\n\n    const handleDismiss = () => {\n        setVisible(false)\n    }\n\n    const onSubmit = (event) => {\n        event.preventDefault();\n        errors.message = \"\";\n        setVisible(true);\n        addUser();\n    }\n\n\n    const panes = [\n        {\n            menuItem: 'Admin Registration',\n            render: () =>\n\n                <Form onSubmit={onSubmit} noValidate className={loading ? \"loading\" : ''}>\n                    <Divider horizontal>Personal Information</Divider>\n\n                    <Form.Group widths='equal'>\n                        <Form.Input\n                            fluid label='Username'\n                            placeholder='Username'\n                            name='username'\n                            value={values.username}\n                            onChange={onChange}\n                        />\n\n                        <Form.Input\n                            fluid label='First name'\n                            placeholder='First name'\n                            name='firstName'\n                            value={values.firstName}\n                            onChange={onChange}\n                        />\n\n                        <Form.Input\n                            fluid label='Last name'\n                            placeholder='Last name'\n                            name='lastName'\n                            value={values.lastName}\n                            onChange={onChange}\n                        />\n                    </Form.Group>\n\n                    <Form.Group widths='equal'>\n                        <Form.Input\n                            fluid label='Password'\n                            placeholder='Password'\n                            name='password'\n                            value={values.password}\n                            onChange={onChange}\n                            type='password'\n                        />\n\n                        <Form.Input\n                            fluid label='Email'\n                            placeholder='Email Address'\n                            name='email'\n                            value={values.email}\n                            onChange={onChange}\n                        />\n                        <Form.Field>\n\n                            <PhoneInput\n                                inputExtraProps={{\n                                    name: \"phoneNumber\",\n                                    required: true,\n                                    autoFocus: true,\n                                    enableSearch: true\n                                }}\n                                name='phoneNumber'\n                                specialLabel='Phone Number'\n                                country={\"ke\"}\n                                value={values.phoneNumber}\n                                onChange={onPhoneNumberChange}\n                            />\n                        </Form.Field>\n                    </Form.Group>\n                    <Form.Checkbox label='I agree to the Terms and Conditions' />\n                    <Form.Button secondary>Register Admin</Form.Button>\n                </Form>,\n        },\n    ];\n\n    return (\n        <div className='.app-container'>\n            <Container>\n                <Grid padded>\n                    <Grid.Row>\n                        <Grid.Column>\n                            <Header as='h1'>Sign Up</Header>\n                            <div className='center'>\n                                Already got an account?\n                            <Link to=\"/\"> Sign In Here</Link>\n                            </div>\n\n                            <Tab className='clear-top' menu={{ secondary: true, pointing: true }} panes={panes} />\n\n                            {visible ?\n                                <Message\n                                    onDismiss={handleDismiss}\n                                    header='System Response'\n                                    content={errors ? errors.message : ''}\n                                />\n                                :\n                                ''\n\n                            }\n\n                        </Grid.Column>\n                    </Grid.Row>\n                </Grid>\n            </Container>\n        </div>\n    );\n}\n\nconst REGISTER_USER = gql`\nmutation createAdmin(\n    $username: String!\n    $firstName: String!\n    $lastName: String!\n    $password: String!\n    $email: String!\n    $phoneNumber: String!\n) {\n  createAdmin(\n  admin:{\n    username: $username\n    password: $password\n    email: $email\n    firstName: $firstName\n    lastName: $lastName\n    phoneNumber: $phoneNumber\n   image:\"https://res.cloudinary.com/dsw3onksq/image/upload/v1592728825/user_x89zcm.png\"\n  }\n  ){\n    status\n    message\n    admin {\n      id\n      username\n      email\n      firstName\n      isSuperuser\n      isActive\n      isStaff\n      image\n      phoneNumber\n      roles\n    }\n  }\n}\n`\nexport default RegisterAdmin;\n"]},"metadata":{},"sourceType":"module"}