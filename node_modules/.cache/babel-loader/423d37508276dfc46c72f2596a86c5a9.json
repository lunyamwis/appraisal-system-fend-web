{"ast":null,"code":"var _jsxFileName = \"/home/actserv/Documents/brooks_insurance_agency_software/brooks-insurance-front-end/src/components/receipts/addNewReceipt.js\";\nimport { useHistory } from 'react-router-dom';\nimport React, { useState, useContext, useEffect, useCallback } from 'react';\nimport { Grid, Container, Header, Icon, Form, Message, Button, Tab } from 'semantic-ui-react';\nimport moment from 'moment';\nimport numWords from 'num-to-words';\nimport { DateInput } from 'semantic-ui-calendar-react';\nimport { useMutation, useQuery } from '@apollo/react-hooks';\nimport { ReceiptContext } from '../../context/receipt';\nimport { FETCH_MINIMAL_MOTOR_POLICIES } from '../policies/queries';\nimport { ADD_NEW_RECEIPT, GET_RECEIPT_OPTS } from './queries';\nimport * as yup from \"yup\";\nimport { AuthContext } from '../../context/auth';\nimport PaymentOptions from './listReceiptOptions';\nimport MotorPolicyList from './listMotorPolicies';\n\nfunction AddNewReceipt({\n  props\n}) {\n  const authContext = useContext(AuthContext);\n  let history = useHistory();\n  const [errors, setErrors] = useState({\n    errorPaths: [],\n    errors: []\n  });\n  const [visible, setVisible] = useState(false);\n  const context = useContext(ReceiptContext);\n  const [successMsg, setSuccessMsg] = useState();\n  const [responseErrors, setResponseErrors] = useState([]);\n  const [receiptOpts, setReceiptOpts] = useState();\n  const [policyNumber, setMotorPolicy] = useState();\n  const [search, setSearch] = useState({\n    search: \"\"\n  });\n  const [values, setValues] = useState({\n    updated: true,\n    afterSubmit: false,\n    policyNumber: []\n  });\n  let schema = yup.object().shape({\n    receiptNumber: yup.string().required(\"Please provide the receipt number\"),\n    date: yup.date().required(\"Please provide the date\"),\n    transactionDate: yup.date().required(\"Please provide the transaction date\"),\n    amountWords: yup.string().required(\"Please provide the amount in words\"),\n    paymentMode: yup.string().required(\"Please indicate the payment mode used\"),\n    policyNumber: yup.string().required(\"Please provide the motor policy \")\n  });\n  const {\n    data: receiptOptsData\n  } = useQuery(GET_RECEIPT_OPTS);\n  useEffect(() => {\n    if (receiptOptsData) {\n      setReceiptOpts(receiptOptsData.receiptOptions);\n    }\n  }, [receiptOptsData, receiptOpts]);\n  const {\n    data: motorPolicyData\n  } = useQuery(FETCH_MINIMAL_MOTOR_POLICIES, {\n    variables: search\n  });\n  useEffect(() => {\n    if (motorPolicyData) {\n      setMotorPolicy(motorPolicyData.motorPolicies.items);\n    }\n  }, [motorPolicyData]);\n  const [addReceipt, {\n    loading\n  }] = useCallback(useMutation(ADD_NEW_RECEIPT, {\n    update(_, result) {\n      context.createReceipt(result.data);\n      setVisible(false);\n      let receiptData = result.data.createMotorReceipt.receipt;\n      history.push({\n        pathname: `/staff/dashboard/receipt/profile/${receiptData.id}`,\n        state: {\n          receipt: receiptData,\n          receiptId: receiptData.id\n        }\n      });\n      setSuccessMsg('Successfully Created A New Receipt');\n    },\n\n    onError(err) {\n      console.log(err.graphQLErrors && err.graphQLErrors[0] ? err.graphQLErrors[0].message : err.networkError && err.networkError.result ? err.networkError.result.errors : err);\n\n      try {\n        if (err.graphQLErrors) {\n          setResponseErrors(err.graphQLErrors[0].message);\n        }\n\n        if (err.networkError !== null && err.networkError !== 'undefined') {\n          setResponseErrors(err.networkError.result.errors[0]);\n        } else if (err.graphQLErrors !== null && err.networkError !== 'undefined') {\n          setResponseErrors(err.graphQLErrors.result.errors[0]);\n        }\n      } catch (e) {\n        setVisible(true);\n      }\n    },\n\n    variables: values\n  }));\n  const validate = useCallback(values => {\n    schema.validate(values, {\n      abortEarly: false\n    }).then(valid => setErrors({\n      errorPaths: [],\n      errors: []\n    })) //called if the entire form is valid\n    .catch(err => {\n      setErrors({\n        errors: err.errors,\n        errorPaths: err.inner.map(i => i.path)\n      });\n    });\n  }, [schema]);\n  useEffect(() => {\n    if (values.updated) {\n      const data = { ...values,\n        updated: false\n      };\n\n      if (values.amountFigures) {\n        data.amountWords = numWords(+values.amountFigures);\n      }\n\n      setValues(data);\n\n      if (values.afterSubmit) {\n        validate(values);\n      }\n    }\n  }, [values, validate]);\n  const onChange = useCallback((event, {\n    name,\n    value\n  }) => {\n    setValues({ ...values,\n      [name]: value,\n      updated: true\n    });\n  }, [values]);\n\n  const handleOnMotorPolicySearch = e => {\n    setSearch({\n      search: e.target.value\n    });\n  };\n\n  const handleOnMotorPolicyChange = (e, {\n    value\n  }) => {\n    e.preventDefault();\n    setValues({ ...values,\n      policyNumber: value,\n      updated: true\n    });\n  };\n\n  const handleOnReceiptOptionsChange = (e, {\n    value\n  }) => {\n    e.preventDefault();\n    setValues({ ...values,\n      paymentMode: value,\n      updated: true\n    });\n  };\n\n  const handleDismiss = () => {\n    setVisible(false);\n    setSuccessMsg('');\n  };\n\n  const onSubmit = event => {\n    event.preventDefault();\n    setSuccessMsg('');\n    validate(values);\n    setValues({ ...values,\n      afterSubmit: true\n    });\n\n    if (Object.keys(values).length > 7 && !errors.errors.length) {\n      addReceipt();\n    }\n\n    setVisible(false);\n  };\n\n  const panes = [{\n    menuItem: \"Create Receipt\",\n    render: () => /*#__PURE__*/React.createElement(Grid.Column, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 17\n      }\n    }, successMsg ? /*#__PURE__*/React.createElement(Message, {\n      positive: true,\n      onDismiss: handleDismiss,\n      header: \"status\",\n      content: successMsg,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 25\n      }\n    }) : '', /*#__PURE__*/React.createElement(Form, {\n      onSubmit: onSubmit,\n      noValidate: true,\n      className: loading ? \"loading\" : '',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Form.Group, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Message, {\n      visible: !!errors.errors.length || visible,\n      warning: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(Message.Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 33\n      }\n    }, \"Please correct the following issues:\"), !!responseErrors.length && /*#__PURE__*/React.createElement(Message, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 61\n      }\n    }, responseErrors), /*#__PURE__*/React.createElement(Message.List, {\n      items: errors.errors,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 34\n      }\n    }))), /*#__PURE__*/React.createElement(Form.Group, {\n      widths: \"equal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Form.Field, {\n      required: true,\n      error: errors.errorPaths.includes('receiptNumber'),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 33\n      }\n    }, \"Receipt Number\"), /*#__PURE__*/React.createElement(Form.Input, {\n      fluid: true,\n      placeholder: \"Receipt Number\",\n      name: \"receiptNumber\",\n      onChange: onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 33\n      }\n    })), /*#__PURE__*/React.createElement(Form.Field, {\n      required: true,\n      error: errors.errorPaths.includes('paymentMode'),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 33\n      }\n    }, \"Payment Mode\"), receiptOpts && receiptOpts.receipt_options && /*#__PURE__*/React.createElement(PaymentOptions, {\n      receiptOptionsList: receiptOpts.receipt_options,\n      handleOnReceiptOptionsChange: handleOnReceiptOptionsChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 80\n      }\n    }))), /*#__PURE__*/React.createElement(Form.Group, {\n      widths: \"equal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Form.Field, {\n      required: true,\n      error: errors.errorPaths.includes('date'),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 33\n      }\n    }, \"Date\"), /*#__PURE__*/React.createElement(DateInput, {\n      name: \"date\",\n      autoComplete: \"off\",\n      placeholder: \"Date\",\n      popupPosition: \"bottom left\",\n      value: values.date ? values.date : \"\",\n      iconPosition: \"left\",\n      dateFormat: \"YYYY-MM-DD\",\n      maxDate: moment(),\n      onChange: onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 33\n      }\n    })), /*#__PURE__*/React.createElement(Form.Field, {\n      required: true,\n      error: errors.errorPaths.includes('transactionDate'),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 33\n      }\n    }, \"Transaction Date\"), /*#__PURE__*/React.createElement(DateInput, {\n      name: \"transactionDate\",\n      autoComplete: \"off\",\n      placeholder: \"Transaction Date\",\n      popupPosition: \"bottom left\",\n      value: values.transactionDate ? values.transactionDate : \"\",\n      iconPosition: \"left\",\n      dateFormat: \"YYYY-MM-DD\",\n      maxDate: moment(),\n      onChange: onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 33\n      }\n    }))), /*#__PURE__*/React.createElement(Form.Group, {\n      widths: \"equal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Form.Field, {\n      required: true,\n      error: errors.errorPaths.includes('amountFigures'),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 33\n      }\n    }, \"Amount (Figures)\"), /*#__PURE__*/React.createElement(Form.Input, {\n      fluid: true,\n      placeholder: \"Amount in Figures\",\n      name: \"amountFigures\",\n      onChange: onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 33\n      }\n    })), /*#__PURE__*/React.createElement(Form.Field, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 33\n      }\n    }, \"Amount (Words)\"), /*#__PURE__*/React.createElement(Form.Input, {\n      fluid: true,\n      placeholder: \"Amount In Words\",\n      name: \"amountWords\",\n      value: values.amountWords ? values.amountWords : \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 33\n      }\n    }))), /*#__PURE__*/React.createElement(Form.Group, {\n      widths: \"equal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Form.Field, {\n      required: true,\n      error: errors.errorPaths.includes('policyNumber'),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 33\n      }\n    }, \"Motor Policy\"), policyNumber && /*#__PURE__*/React.createElement(MotorPolicyList, {\n      motorPoliciesOptions: policyNumber,\n      handleOnMotorPolicySearch: handleOnMotorPolicySearch,\n      handleOnMotorPolicyChange: handleOnMotorPolicyChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 50\n      }\n    }))), /*#__PURE__*/React.createElement(Button, {\n      type: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 25\n      }\n    }, \"Generate Receipt\")))\n  }];\n  return /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    padded: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Grid.Column, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"content-wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    as: \"h2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"settings\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 29\n    }\n  }), /*#__PURE__*/React.createElement(Header.Content, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    href: \"/staff/dashboard/overview\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 33\n    }\n  }, \"Overview\"), \" \", '>', \" \", /*#__PURE__*/React.createElement(\"a\", {\n    href: \"/staff/dashboard/receipt/view-receipts\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 88\n    }\n  }, \"Receipts\"), \" \", '>', \" Receipt\", /*#__PURE__*/React.createElement(Header.Subheader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 17\n    }\n  }, \"Hello there \", authContext.user.username, \", Fill in this form to generate a receipt\")))))), /*#__PURE__*/React.createElement(Tab, {\n    className: \"clear-top\",\n    menu: {\n      secondary: true,\n      pointing: true\n    },\n    panes: panes,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 13\n    }\n  }));\n}\n\nexport default AddNewReceipt;","map":{"version":3,"sources":["/home/actserv/Documents/brooks_insurance_agency_software/brooks-insurance-front-end/src/components/receipts/addNewReceipt.js"],"names":["useHistory","React","useState","useContext","useEffect","useCallback","Grid","Container","Header","Icon","Form","Message","Button","Tab","moment","numWords","DateInput","useMutation","useQuery","ReceiptContext","FETCH_MINIMAL_MOTOR_POLICIES","ADD_NEW_RECEIPT","GET_RECEIPT_OPTS","yup","AuthContext","PaymentOptions","MotorPolicyList","AddNewReceipt","props","authContext","history","errors","setErrors","errorPaths","visible","setVisible","context","successMsg","setSuccessMsg","responseErrors","setResponseErrors","receiptOpts","setReceiptOpts","policyNumber","setMotorPolicy","search","setSearch","values","setValues","updated","afterSubmit","schema","object","shape","receiptNumber","string","required","date","transactionDate","amountWords","paymentMode","data","receiptOptsData","receiptOptions","motorPolicyData","variables","motorPolicies","items","addReceipt","loading","update","_","result","createReceipt","receiptData","createMotorReceipt","receipt","push","pathname","id","state","receiptId","onError","err","console","log","graphQLErrors","message","networkError","e","validate","abortEarly","then","valid","catch","inner","map","i","path","amountFigures","onChange","event","name","value","handleOnMotorPolicySearch","target","handleOnMotorPolicyChange","preventDefault","handleOnReceiptOptionsChange","handleDismiss","onSubmit","Object","keys","length","panes","menuItem","render","includes","receipt_options","user","username","secondary","pointing"],"mappings":"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","sourcesContent":["import { useHistory } from 'react-router-dom';\nimport React, { useState, useContext, useEffect, useCallback } from 'react';\nimport {\n    Grid,\n    Container,\n    Header,\n    Icon,\n    Form,\n    Message,\n    Button,\n    Tab\n} from 'semantic-ui-react';\nimport moment from 'moment';\nimport numWords from 'num-to-words'\nimport { DateInput } from 'semantic-ui-calendar-react';\nimport { useMutation, useQuery } from '@apollo/react-hooks';\nimport { ReceiptContext } from '../../context/receipt';\nimport { FETCH_MINIMAL_MOTOR_POLICIES } from '../policies/queries';\nimport { ADD_NEW_RECEIPT, GET_RECEIPT_OPTS } from './queries'\nimport * as yup from \"yup\";\nimport { AuthContext } from '../../context/auth';\nimport PaymentOptions from './listReceiptOptions';\nimport MotorPolicyList from './listMotorPolicies';\n\n\nfunction AddNewReceipt({ props }) {\n\n    const authContext = useContext(AuthContext);\n    let history = useHistory();\n\n    const [errors, setErrors] = useState({\n        errorPaths: [],\n        errors: []\n    });\n    const [visible, setVisible] = useState(false);\n\n    const context = useContext(ReceiptContext);\n    const [successMsg, setSuccessMsg] = useState();\n    const [responseErrors, setResponseErrors] = useState([]);\n    const [receiptOpts, setReceiptOpts] = useState();\n\n    const [policyNumber, setMotorPolicy] = useState();\n    const [search, setSearch] = useState({ search: \"\" });\n    const [values, setValues] = useState({\n        updated: true,\n        afterSubmit: false,\n        policyNumber: []\n    });\n\n    let schema = yup.object().shape({\n        receiptNumber: yup.string().required(\"Please provide the receipt number\"),\n        date: yup.date().required(\"Please provide the date\"),\n        transactionDate: yup.date().required(\"Please provide the transaction date\"),\n        amountWords: yup.string().required(\"Please provide the amount in words\"),\n        paymentMode: yup.string().required(\"Please indicate the payment mode used\"),\n        policyNumber: yup.string().required(\"Please provide the motor policy \"),\n    });\n\n\n    const { data: receiptOptsData } = useQuery(GET_RECEIPT_OPTS);\n    useEffect(() => {\n        if (receiptOptsData) {\n            setReceiptOpts(receiptOptsData.receiptOptions);\n        }\n    }, [receiptOptsData, receiptOpts]);\n\n\n    const { data: motorPolicyData } = useQuery(FETCH_MINIMAL_MOTOR_POLICIES, {\n        variables: search\n    });\n    useEffect(() => {\n        if (motorPolicyData) {\n            setMotorPolicy(motorPolicyData.motorPolicies.items)\n        }\n    }, [motorPolicyData])\n\n    const [addReceipt, { loading }] = useCallback(useMutation(ADD_NEW_RECEIPT, {\n        update(_, result) {\n\n            context.createReceipt(result.data);\n            setVisible(false);\n            let receiptData = result.data.createMotorReceipt.receipt\n            history.push({\n                pathname: `/staff/dashboard/receipt/profile/${receiptData.id}`,\n                state: { receipt: receiptData, receiptId: receiptData.id }\n            })\n\n            setSuccessMsg('Successfully Created A New Receipt');\n        },\n        onError(err) {\n            console.log(err.graphQLErrors && err.graphQLErrors[0] ? err.graphQLErrors[0].message : err.networkError && err.networkError.result ? err.networkError.result.errors : err)\n            try {\n                if (err.graphQLErrors) {\n                    setResponseErrors(err.graphQLErrors[0].message);\n                }\n\n                if (err.networkError !== null && err.networkError !== 'undefined') {\n\n                    setResponseErrors(err.networkError.result.errors[0]);\n\n                } else if (err.graphQLErrors !== null && err.networkError !== 'undefined') {\n\n                    setResponseErrors(err.graphQLErrors.result.errors[0]);\n\n                }\n            } catch (e) {\n                setVisible(true);\n            }\n\n        },\n        variables: values\n    }));\n\n    const validate = useCallback((values) => {\n        schema.validate(values, { abortEarly: false })\n            .then(valid => setErrors({ errorPaths: [], errors: [] })) //called if the entire form is valid\n            .catch(err => {\n                setErrors({ errors: err.errors, errorPaths: err.inner.map(i => i.path) })\n            })\n    }, [schema])\n\n\n    useEffect(() => {\n        if (values.updated) {\n            const data = { ...values, updated: false }\n            if (values.amountFigures) {\n                data.amountWords = numWords(+values.amountFigures)\n            }\n            setValues(data)\n            if (values.afterSubmit) {\n                validate(values)\n            }\n        }\n\n    }, [values, validate])\n\n    const onChange = useCallback((event, { name, value }) => {\n        setValues({ ...values, [name]: value, updated: true });\n    }, [values])\n\n\n\n\n    const handleOnMotorPolicySearch = (e) => {\n        setSearch({ search: e.target.value });\n    }\n\n\n    const handleOnMotorPolicyChange = (e, { value }) => {\n        e.preventDefault()\n        setValues({ ...values, policyNumber: value, updated: true });\n    }\n\n    const handleOnReceiptOptionsChange = (e, { value }) => {\n        e.preventDefault()\n        setValues({ ...values, paymentMode: value, updated: true });\n    }\n\n\n\n    const handleDismiss = () => {\n        setVisible(false);\n        setSuccessMsg('');\n    }\n\n    const onSubmit = (event) => {\n        event.preventDefault();\n        setSuccessMsg('');\n        validate(values)\n        setValues({ ...values, afterSubmit: true })\n        if (Object.keys(values).length > 7 && !errors.errors.length) { addReceipt() }\n        setVisible(false);\n    }\n    const panes = [\n\n        {\n            menuItem: \"Create Receipt\",\n            render: () =>\n                <Grid.Column>\n                    {successMsg ?\n                        <Message\n                            positive\n                            onDismiss={handleDismiss}\n                            header='status'\n                            content={successMsg} /> :\n                        ''}\n\n                    <Form onSubmit={onSubmit} noValidate className={loading ? \"loading\" : ''}>\n                        <Form.Group>\n                            <Message visible={!!errors.errors.length || visible} warning>\n                                <Message.Header>Please correct the following issues:</Message.Header>\n                                {!!responseErrors.length && <Message>{responseErrors}</Message>}\n                                {<Message.List items={errors.errors} />}\n                            </Message>\n                        </Form.Group>\n                        <Form.Group widths='equal'>\n                            <Form.Field required error={errors.errorPaths.includes('receiptNumber')}>\n                                <label>Receipt Number</label>\n                                <Form.Input\n                                    fluid\n                                    placeholder='Receipt Number'\n                                    name='receiptNumber'\n                                    onChange={onChange}\n                                />\n                            </Form.Field>\n\n                            <Form.Field required error={errors.errorPaths.includes('paymentMode')}>\n                                <label>Payment Mode</label>\n                                {receiptOpts && receiptOpts.receipt_options && <PaymentOptions\n                                    receiptOptionsList={receiptOpts.receipt_options}\n                                    handleOnReceiptOptionsChange={handleOnReceiptOptionsChange}\n                                />}\n                            </Form.Field>\n                        </Form.Group>\n                        <Form.Group widths='equal'>\n                            <Form.Field required error={errors.errorPaths.includes('date')}>\n                                <label>Date</label>\n\n                                <DateInput\n                                    name=\"date\"\n                                    autoComplete=\"off\"\n                                    placeholder=\"Date\"\n                                    popupPosition=\"bottom left\"\n                                    value={values.date ? values.date : \"\"}\n                                    iconPosition=\"left\"\n                                    dateFormat=\"YYYY-MM-DD\"\n                                    maxDate={moment()}\n                                    onChange={onChange}\n                                />\n                            </Form.Field>\n                            <Form.Field required error={errors.errorPaths.includes('transactionDate')}>\n                                <label>Transaction Date</label>\n\n                                <DateInput\n                                    name=\"transactionDate\"\n                                    autoComplete=\"off\"\n                                    placeholder=\"Transaction Date\"\n                                    popupPosition=\"bottom left\"\n                                    value={values.transactionDate ? values.transactionDate : \"\"}\n                                    iconPosition=\"left\"\n                                    dateFormat=\"YYYY-MM-DD\"\n                                    maxDate={moment()}\n                                    onChange={onChange}\n                                />\n                            </Form.Field>\n                        </Form.Group>\n                        <Form.Group widths='equal'>\n                            <Form.Field required error={errors.errorPaths.includes('amountFigures')}>\n                                <label>Amount (Figures)</label>\n                                <Form.Input fluid placeholder='Amount in Figures'\n                                    name='amountFigures'\n                                    onChange={onChange}\n                                />\n                            </Form.Field>\n                            <Form.Field>\n                                <label>Amount (Words)</label>\n                                <Form.Input fluid placeholder='Amount In Words'\n                                    name='amountWords'\n                                    value={values.amountWords ? values.amountWords : \"\"}\n                                />\n                            </Form.Field>\n                        </Form.Group>\n                        <Form.Group widths=\"equal\">\n                            <Form.Field required error={errors.errorPaths.includes('policyNumber')}>\n                                <label>Motor Policy</label>\n\n                                {policyNumber && <MotorPolicyList\n                                    motorPoliciesOptions={policyNumber}\n                                    handleOnMotorPolicySearch={handleOnMotorPolicySearch}\n                                    handleOnMotorPolicyChange={handleOnMotorPolicyChange}\n                                />}\n                            </Form.Field>\n                        </Form.Group>\n                        <Button type='submit'>Generate Receipt</Button>\n\n                    </Form>\n                </Grid.Column>\n\n        }\n    ]\n    return (\n        <Container>\n            <Grid container padded>\n                <Grid.Column>\n                    <div className=\"content-wrapper\">\n                        <Header as='h2'>\n                            <Icon name='settings' />\n                            <Header.Content>\n                                <a href=\"/staff/dashboard/overview\">Overview</a> {'>'} <a href=\"/staff/dashboard/receipt/view-receipts\">Receipts</a> {'>'} Receipt\n                <Header.Subheader>\n                                    Hello there {authContext.user.username}, Fill in this form to generate a receipt\n                </Header.Subheader>\n                            </Header.Content>\n                        </Header>\n                    </div>\n                </Grid.Column>\n            </Grid>\n            <Tab className='clear-top' menu={{ secondary: true, pointing: true }} panes={panes} />\n        </Container>\n    )\n}\n\nexport default AddNewReceipt;"]},"metadata":{},"sourceType":"module"}