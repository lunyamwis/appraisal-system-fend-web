{"ast":null,"code":"var _jsxFileName = \"/home/actserv/Documents/brooks_insurance_agency_software/brooks-insurance-front-end/src/components/staff/addNewClient.js\";\nimport React, { useState, useContext, useEffect, useCallback } from 'react';\nimport { Grid, Container, Header, Icon, Form, Message, Button, Dropdown } from 'semantic-ui-react';\nimport moment from 'moment';\nimport { DateInput } from 'semantic-ui-calendar-react';\nimport { useMutation } from '@apollo/react-hooks';\nimport { ClientContext } from '../../context/clients';\nimport { ADD_NEW_CLIENT } from './queries';\nimport * as yup from \"yup\";\n\nfunction AddNewClient(props) {\n  const [errors, setErrors] = useState({\n    errorPaths: [],\n    errors: []\n  });\n  const context = useContext(ClientContext);\n  const [successMsg, setSuccessMsg] = useState();\n  const [responseErrors, setResponseErrors] = useState([]);\n  const [client, setClient] = useState({});\n  const [values, setValues] = useState({\n    updated: true,\n    afterSubmit: false\n  });\n  let schema = yup.object().shape({\n    email: yup.string().required(\"Please provide an email address\"),\n    firstName: yup.string().required(\"Please provide the first name\"),\n    lastName: yup.string().required(\"Please provide the last name\"),\n    phoneNumber: yup.string().required(\"Please provide a phone number\"),\n    town: yup.string().required(\"Please provide the town of residence\"),\n    surname: yup.string().required(\"Please provide the surname\"),\n    dateOfBirth: yup.date().required(\"Please select the start date\"),\n    gender: yup.string().required(\"Please select the gender\"),\n    idNumber: yup.number().required(\"Please provide the ID number\"),\n    kraPin: yup.string().required(\"Please provide the KRA pin\").matches(/((\\d+[A-Z])|([A-Z]+\\d)[\\dA-Z]*)/, {\n      excludeEmptyString: true,\n      message: \"Enter a valid KRA pin\"\n    })\n  });\n  const [addClient, {\n    loading\n  }] = useCallback(useMutation(ADD_NEW_CLIENT, {\n    update(_, result) {\n      context.registerClient(result.data);\n      setVisible(false);\n      console.log(\"response\", result.data.createIndividualClient.message);\n      console.log(\"saved data\", result.data.createIndividualClient.individualClient);\n      setClient(result.data.createIndividualClient.individualClient);\n      setSuccessMsg('Successfully Registered New Client');\n    },\n\n    onError(err) {\n      try {\n        if (err.graphQLErrors) {\n          setResponseErrors(err.graphQLErrors[0].message);\n        }\n\n        if (err.networkError !== null && err.networkError !== 'undefined') {\n          setResponseErrors(err.networkError.result.errors[0]);\n        } else if (err.graphQLErrors !== null && err.networkError !== 'undefined') {\n          setResponseErrors(err.graphQLErrors.result.errors[0]);\n        }\n      } catch (e) {\n        setVisible(true);\n      }\n    },\n\n    variables: values\n  }));\n  const validate = useCallback(values => {\n    schema.validate(values, {\n      abortEarly: false\n    }).then(valid => setErrors({\n      errorPaths: [],\n      errors: []\n    })) //called if the entire form is valid\n    .catch(err => {\n      setErrors({\n        errors: err.errors,\n        errorPaths: err.inner.map(i => i.path)\n      });\n    });\n  }, [schema]);\n  useEffect(() => {\n    if (values.updated) {\n      setValues({ ...values,\n        updated: false\n      });\n\n      if (values.afterSubmit) {\n        validate(values);\n      }\n    }\n  }, [values, validate]);\n\n  const handleOnGenderChange = (e, {\n    value\n  }) => {\n    e.preventDefault();\n    setValues({ ...values,\n      gender: value,\n      updated: true\n    });\n  };\n\n  const onChange = useCallback((event, {\n    name,\n    value\n  }) => {\n    setValues({ ...values,\n      [name]: value,\n      updated: true\n    });\n  }, [values]);\n  const [visible, setVisible] = useState(false);\n\n  const handleDismiss = () => {\n    setVisible(false);\n    setSuccessMsg('');\n  };\n\n  const genderOptions = [{\n    key: 'F',\n    text: 'Female',\n    value: 'F'\n  }, {\n    key: 'M',\n    text: 'Male',\n    value: 'M'\n  }, {\n    key: 'O',\n    text: 'Other',\n    value: 'O'\n  }];\n\n  const onSubmit = event => {\n    event.preventDefault();\n    setSuccessMsg('');\n    validate(values);\n    setValues({ ...values,\n      afterSubmit: true\n    });\n\n    if (Object.keys(values).length > 7 && !errors.errors.length) {\n      addClient();\n    }\n\n    setVisible(false);\n    console.log(\"errors\", errors);\n  };\n\n  useEffect(() => {\n    if (client.id) {\n      props.history.push({\n        pathname: `/staff/dashboard/client-records`,\n        state: {\n          client: client.data\n        }\n      });\n    }\n  });\n  return /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    padded: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Grid.Column, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"content-wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    as: \"h2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"settings\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 29\n    }\n  }), /*#__PURE__*/React.createElement(Header.Content, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    href: \"/staff/dashboard/client-records\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 33\n    }\n  }, \"Client Records\"), \" \", '>', \" Register New Client\", /*#__PURE__*/React.createElement(Header.Subheader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 17\n    }\n  }, \"Fill in this form to register a new client\")))))), /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    padded: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Grid.Column, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 17\n    }\n  }, successMsg ? /*#__PURE__*/React.createElement(Message, {\n    positive: true,\n    onDismiss: handleDismiss,\n    header: \"status\",\n    content: successMsg,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 25\n    }\n  }) : '', /*#__PURE__*/React.createElement(Form, {\n    onSubmit: onSubmit,\n    noValidate: true,\n    className: loading ? \"loading\" : '',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Form.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Message, {\n    visible: !!errors.errors.length || visible,\n    warning: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Message.Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 33\n    }\n  }, \"Please correct the following issues:\"), !!responseErrors.length && /*#__PURE__*/React.createElement(Message, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 61\n    }\n  }, responseErrors), /*#__PURE__*/React.createElement(Message.List, {\n    items: errors.errors,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 34\n    }\n  }))), /*#__PURE__*/React.createElement(Form.Group, {\n    widths: \"equal\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('firstName'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 33\n    }\n  }, \"First Name\"), /*#__PURE__*/React.createElement(Form.Input, {\n    fluid: true,\n    placeholder: \"First Name\",\n    name: \"firstName\",\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('lastName'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 33\n    }\n  }, \"Last Name\"), /*#__PURE__*/React.createElement(Form.Input, {\n    fluid: true,\n    placeholder: \"Last Name\",\n    name: \"lastName\",\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('surname'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 33\n    }\n  }, \"Other Name\"), /*#__PURE__*/React.createElement(Form.Input, {\n    fluid: true,\n    placeholder: \"Other Name\",\n    name: \"surname\",\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(Form.Field, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 33\n    }\n  }, \"Postal Address\"), /*#__PURE__*/React.createElement(Form.Input, {\n    fluid: true,\n    placeholder: \"Post Address\",\n    name: \"postalAddress\",\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 33\n    }\n  }))), /*#__PURE__*/React.createElement(Form.Group, {\n    widths: \"equal\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('kraPin'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 33\n    }\n  }, \"KRA PIN Number\"), /*#__PURE__*/React.createElement(Form.Input, {\n    fluid: true,\n    placeholder: \"KRA PIN Number\",\n    name: \"kraPin\",\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('firstName'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 33\n    }\n  }, \"Occupation\"), /*#__PURE__*/React.createElement(Form.Input, {\n    fluid: true,\n    placeholder: \"Occupation\",\n    name: \"occupation\",\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('phoneNumber'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 33\n    }\n  }, \"Phone Number\"), /*#__PURE__*/React.createElement(Form.Input, {\n    fluid: true,\n    placeholder: \"Phone Number\",\n    name: \"phoneNumber\",\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('town'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 33\n    }\n  }, \"Residence (Town)\"), /*#__PURE__*/React.createElement(Form.Input, {\n    fluid: true,\n    placeholder: \"Residence (Town)\",\n    name: \"town\",\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 33\n    }\n  }))), /*#__PURE__*/React.createElement(Form.Group, {\n    widths: \"equal\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('idNumber'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 33\n    }\n  }, \"ID Number\"), /*#__PURE__*/React.createElement(Form.Input, {\n    fluid: true,\n    placeholder: \"ID Number\",\n    name: \"idNumber\",\n    type: \"number\",\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('email'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 33\n    }\n  }, \"Email Address\"), /*#__PURE__*/React.createElement(Form.Input, {\n    fluid: true,\n    placeholder: \"Email Address\",\n    name: \"email\",\n    type: \"email\",\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('gender'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 33\n    }\n  }, \"Gender\"), /*#__PURE__*/React.createElement(Dropdown, {\n    placeholder: \"Select Gender\",\n    fluid: true,\n    selection: true,\n    onChange: handleOnGenderChange,\n    options: genderOptions,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('dateOfBirth'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 280,\n      columnNumber: 33\n    }\n  }, \"Date Of Birth\"), /*#__PURE__*/React.createElement(DateInput, {\n    name: \"dateOfBirth\",\n    placeholder: \"Date Of Birth\",\n    popupPosition: \"bottom left\",\n    value: values.dateOfBirth ? values.dateOfBirth : \"\",\n    iconPosition: \"left\",\n    maxDate: moment(),\n    onChange: onChange,\n    dateFormat: \"DD-MM-YYYYMM-DD\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 33\n    }\n  }))), /*#__PURE__*/React.createElement(Button, {\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 25\n    }\n  }, \"Register Client\")))));\n}\n\nexport default AddNewClient;","map":{"version":3,"sources":["/home/actserv/Documents/brooks_insurance_agency_software/brooks-insurance-front-end/src/components/staff/addNewClient.js"],"names":["React","useState","useContext","useEffect","useCallback","Grid","Container","Header","Icon","Form","Message","Button","Dropdown","moment","DateInput","useMutation","ClientContext","ADD_NEW_CLIENT","yup","AddNewClient","props","errors","setErrors","errorPaths","context","successMsg","setSuccessMsg","responseErrors","setResponseErrors","client","setClient","values","setValues","updated","afterSubmit","schema","object","shape","email","string","required","firstName","lastName","phoneNumber","town","surname","dateOfBirth","date","gender","idNumber","number","kraPin","matches","excludeEmptyString","message","addClient","loading","update","_","result","registerClient","data","setVisible","console","log","createIndividualClient","individualClient","onError","err","graphQLErrors","networkError","e","variables","validate","abortEarly","then","valid","catch","inner","map","i","path","handleOnGenderChange","value","preventDefault","onChange","event","name","visible","handleDismiss","genderOptions","key","text","onSubmit","Object","keys","length","id","history","push","pathname","state","includes"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect, useCallback } from 'react';\nimport {\n    Grid,\n    Container,\n    Header,\n    Icon,\n    Form,\n    Message,\n    Button,\n    Dropdown\n} from 'semantic-ui-react';\nimport moment from 'moment';\nimport { DateInput } from 'semantic-ui-calendar-react';\nimport { useMutation } from '@apollo/react-hooks';\nimport { ClientContext } from '../../context/clients';\nimport { ADD_NEW_CLIENT } from './queries'\nimport * as yup from \"yup\";\n\nfunction AddNewClient(props) {\n    const [errors, setErrors] = useState({\n        errorPaths: [],\n        errors: []\n    });\n    const context = useContext(ClientContext);\n    const [successMsg, setSuccessMsg] = useState();\n    const [responseErrors, setResponseErrors] = useState([]);\n    const [client, setClient] = useState({});\n\n\n    const [values, setValues] = useState({\n        updated: true,\n        afterSubmit: false\n    });\n    let schema = yup.object().shape({\n        email: yup.string().required(\"Please provide an email address\"),\n        firstName: yup.string().required(\"Please provide the first name\"),\n        lastName: yup.string().required(\"Please provide the last name\"),\n        phoneNumber: yup.string().required(\"Please provide a phone number\"),\n        town: yup.string().required(\"Please provide the town of residence\"),\n        surname: yup.string().required(\"Please provide the surname\"),\n        dateOfBirth: yup.date().required(\"Please select the start date\"),\n        gender: yup.string().required(\"Please select the gender\"),\n        idNumber: yup.number().required(\"Please provide the ID number\"),\n        kraPin: yup.string().required(\"Please provide the KRA pin\").matches(/((\\d+[A-Z])|([A-Z]+\\d)[\\dA-Z]*)/, { excludeEmptyString: true, message: \"Enter a valid KRA pin\" }),\n    });\n\n\n    const [addClient, { loading }] = useCallback(useMutation(ADD_NEW_CLIENT, {\n        update(_, result) {\n            context.registerClient(result.data);\n            setVisible(false);\n\n            console.log(\"response\", result.data.createIndividualClient.message);\n            console.log(\"saved data\", result.data.createIndividualClient.individualClient);\n            setClient(result.data.createIndividualClient.individualClient)\n\n            setSuccessMsg('Successfully Registered New Client');\n        },\n        onError(err) {\n            try {\n                if (err.graphQLErrors) {\n                    setResponseErrors(err.graphQLErrors[0].message);\n                }\n\n                if (err.networkError !== null && err.networkError !== 'undefined') {\n\n                    setResponseErrors(err.networkError.result.errors[0]);\n\n                } else if (err.graphQLErrors !== null && err.networkError !== 'undefined') {\n\n                    setResponseErrors(err.graphQLErrors.result.errors[0]);\n\n                }\n            } catch (e) {\n                setVisible(true);\n            }\n\n        },\n        variables: values\n    }));\n\n    const validate = useCallback((values) => {\n        schema.validate(values, { abortEarly: false })\n            .then(valid => setErrors({ errorPaths: [], errors: [] })) //called if the entire form is valid\n            .catch(err => {\n                setErrors({ errors: err.errors, errorPaths: err.inner.map(i => i.path) })\n            })\n    }, [schema])\n\n    useEffect(() => {\n        if (values.updated) {\n            setValues({ ...values, updated: false })\n            if (values.afterSubmit) {\n                validate(values)\n            }\n        }\n    }, [values, validate])\n    const handleOnGenderChange = (e, { value }) => {\n        e.preventDefault()\n        setValues({ ...values, gender: value, updated: true });\n    }\n    const onChange = useCallback((event, {name, value}) => {\n        setValues({ ...values, [name]: value, updated: true });\n    }, [values])\n    const [visible, setVisible] = useState(false);\n\n    const handleDismiss = () => {\n        setVisible(false);\n        setSuccessMsg('');\n    }\n    const genderOptions = [\n        {\n            key: 'F',\n            text: 'Female',\n            value: 'F',\n        },\n        {\n            key: 'M',\n            text: 'Male',\n            value: 'M',\n        },\n        {\n            key: 'O',\n            text: 'Other',\n            value: 'O',\n        }\n    ]\n    const onSubmit = (event) => {\n        event.preventDefault();\n        setSuccessMsg('');\n        validate(values)\n        setValues({ ...values, afterSubmit: true })\n        if (Object.keys(values).length > 7 && !errors.errors.length) { addClient() }\n        setVisible(false);\n        console.log(\"errors\", errors)\n    }\n    useEffect(() => {\n        if (client.id) {\n            props.history.push({\n                pathname: `/staff/dashboard/client-records`,\n                state: { client: client.data }\n            })\n        }\n    })\n    return (\n        <Container>\n            <Grid container padded>\n                <Grid.Column>\n                    <div className=\"content-wrapper\">\n                        <Header as='h2'>\n                            <Icon name='settings' />\n                            <Header.Content>\n                                <a href=\"/staff/dashboard/client-records\">Client Records</a> {'>'} Register New Client\n                <Header.Subheader>\n                                    Fill in this form to register a new client\n                </Header.Subheader>\n                            </Header.Content>\n                        </Header>\n                    </div>\n                </Grid.Column>\n            </Grid>\n\n            <Grid container padded>\n                <Grid.Column>\n                    {successMsg ?\n                        <Message\n                            positive\n                            onDismiss={handleDismiss}\n                            header='status'\n                            content={successMsg} /> :\n                        ''}\n\n                    <Form onSubmit={onSubmit} noValidate className={loading ? \"loading\" : ''}>\n                    <Form.Group>\n                            <Message visible={!!errors.errors.length || visible} warning>\n                                <Message.Header>Please correct the following issues:</Message.Header>\n                                {!!responseErrors.length && <Message>{responseErrors}</Message>}\n                                {<Message.List items={errors.errors} />}\n                            </Message>\n                        </Form.Group>\n                        <Form.Group widths='equal'>\n                            <Form.Field required error={errors.errorPaths.includes('firstName')}>\n                                <label>First Name</label>\n                                <Form.Input\n                                    fluid\n                                    placeholder='First Name'\n                                    name='firstName'\n                                    onChange={onChange}\n                                />\n                            </Form.Field>\n                            <Form.Field required error={errors.errorPaths.includes('lastName')}>\n                                <label>Last Name</label>\n                                <Form.Input fluid placeholder='Last Name'\n                                    name='lastName'\n                                    onChange={onChange}\n\n                                />\n                            </Form.Field>\n                            <Form.Field required error={errors.errorPaths.includes('surname')}>\n                                <label>Other Name</label>\n                                <Form.Input fluid placeholder='Other Name'\n                                    name='surname'\n                                    onChange={onChange}\n                                />\n                            </Form.Field>\n                            <Form.Field>\n                                <label>Postal Address</label>\n                                <Form.Input fluid placeholder='Post Address'\n                                    name='postalAddress'\n                                    onChange={onChange}\n                                />\n                            </Form.Field>\n\n                        </Form.Group>\n                        <Form.Group widths='equal'>\n                            <Form.Field required error={errors.errorPaths.includes('kraPin')}>\n                                <label>KRA PIN Number</label>\n                                <Form.Input fluid placeholder='KRA PIN Number'\n                                    name='kraPin'\n                                    onChange={onChange}\n\n                                />\n                            </Form.Field>\n                            <Form.Field required error={errors.errorPaths.includes('firstName')}>\n                                <label>Occupation</label>\n                                <Form.Input fluid placeholder='Occupation'\n                                    name='occupation'\n                                    onChange={onChange}\n\n                                />\n                            </Form.Field>\n                            <Form.Field required error={errors.errorPaths.includes('phoneNumber')}>\n                                <label>Phone Number</label>\n                                <Form.Input fluid placeholder='Phone Number'\n                                    name='phoneNumber'\n                                    onChange={onChange}\n\n                                />\n                            </Form.Field>\n                            <Form.Field required error={errors.errorPaths.includes('town')}>\n                                <label>Residence (Town)</label>\n                                <Form.Input\n                                    fluid placeholder='Residence (Town)'\n                                    name='town'\n                                    onChange={onChange}\n\n                                />\n                            </Form.Field>\n                        </Form.Group>\n                        <Form.Group widths='equal'>\n                            <Form.Field required error={errors.errorPaths.includes('idNumber')}>\n                                <label>ID Number</label>\n                                <Form.Input fluid placeholder='ID Number'\n                                    name='idNumber'\n                                    type=\"number\"\n                                    onChange={onChange}\n\n                                />\n                            </Form.Field>\n                            <Form.Field required error={errors.errorPaths.includes('email')}>\n                                <label>Email Address</label>\n                                <Form.Input fluid placeholder='Email Address'\n                                    name='email'\n                                    type=\"email\"\n                                    onChange={onChange}\n\n                                />\n                            </Form.Field>\n                            <Form.Field required error={errors.errorPaths.includes('gender')}>\n                                <label>Gender</label>\n                                <Dropdown\n                                    placeholder='Select Gender'\n                                    fluid\n                                    selection\n                                    onChange={handleOnGenderChange}\n                                    options={genderOptions}\n                                />\n                            </Form.Field>\n                            <Form.Field required error={errors.errorPaths.includes('dateOfBirth')}>\n                                <label>Date Of Birth</label>\n\n                                <DateInput\n                                    name=\"dateOfBirth\"\n                                    placeholder=\"Date Of Birth\"\n                                    popupPosition=\"bottom left\"\n                                    value={values.dateOfBirth ? values.dateOfBirth : \"\"}\n                                    iconPosition=\"left\"\n                                    maxDate={moment()}\n                                    onChange={onChange}\n                                    dateFormat=\"DD-MM-YYYYMM-DD\"\n                                />\n                            </Form.Field>\n                        </Form.Group>\n                        <Button type='submit'>Register Client</Button>\n\n                    </Form>\n                    {/* {setVisible && <Message warning visible={!!errors.errors.length || visible} onDismiss={handleDismiss}>\n                        <Message.Header >Please correct the following issues:</Message.Header>\n                        {!!responseErrors.length && <Message>{responseErrors}</Message>}\n                        {<Message.List items={errors.errors} />}\n                    </Message>} */}\n\n                    {/* {visible ?\n                        <Message\n                            negative\n                            onDismiss={handleDismiss}\n                            header='status'\n                            content={content}\n\n                        />\n\n                        :\n                        ''\n\n                    } */}\n                </Grid.Column>\n            </Grid>\n        </Container>\n    )\n}\n\nexport default AddNewClient;"]},"metadata":{},"sourceType":"module"}