{"ast":null,"code":"var _jsxFileName = \"/home/actserv/Documents/brooks_insurance_agency_software/brooks-insurance-front-end/src/components/contactPersons/addNewContactPerson.js\";\nimport { useHistory } from 'react-router-dom';\nimport { useMutation, useQuery } from '@apollo/react-hooks';\nimport React, { useState, useContext, useEffect, useCallback } from 'react';\nimport { Grid, Container, Header, Icon, Form, Message, Button, Dropdown } from 'semantic-ui-react';\nimport moment from 'moment';\nimport { DateInput } from 'semantic-ui-calendar-react';\nimport { ContactPersonContext } from '../../context/contactPerson';\nimport Clients from '../contactPersons/listContacts';\nimport IndividualClients from '../policies/listClients';\nimport { ADD_NEW_CONTACT_PERSON } from './queries';\nimport { GET_CORPORATE_CLIENTS, FETCH_CLIENTS_QUERY } from '../clients/queries';\nimport * as yup from \"yup\";\nimport { AuthContext } from '../../context/auth';\nimport PhoneInput from 'react-phone-input-2';\n\nfunction AddNewContactPerson({\n  props\n}) {\n  const authContext = useContext(AuthContext);\n  let history = useHistory();\n  const [errors, setErrors] = useState({\n    errorPaths: [],\n    errors: []\n  });\n  const context = useContext(ContactPersonContext);\n  const [successMsg, setSuccessMsg] = useState();\n  const [corporateClients, setCorporateClients] = useState();\n  const [individualClients, setIndividualClients] = useState();\n  const [search, setSearch] = useState({\n    search: \"\"\n  });\n  const [responseErrors, setResponseErrors] = useState([]);\n  const [values, setValues] = useState({\n    updated: true,\n    afterSubmit: false,\n    individualClients: [],\n    corporateClients: []\n  });\n  let schema = yup.object().shape({\n    email: yup.string().required(\"Please provide an email address\"),\n    name: yup.string().required(\"Please provide the name\"),\n    // client: yup.string().required(\"Please  select the client\"),\n    phoneNumber: yup.string().required(\"Please provide a phone number\"),\n    position: yup.string().required(\"Please provide the position\"),\n    serviceLine: yup.string().required(\"Please provide the service line\"),\n    town: yup.string().required(\"Please provide the town of residence\"),\n    dateOfBirth: yup.date().required(\"Please input the date of birth\"),\n    gender: yup.string().required(\"Please select the gender\")\n  });\n  const {\n    data: corporateClientsData\n  } = useQuery(GET_CORPORATE_CLIENTS, {\n    variables: search\n  });\n  const {\n    data: individualClientsData\n  } = useQuery(FETCH_CLIENTS_QUERY, {\n    variables: search\n  });\n  useEffect(() => {\n    if (corporateClientsData) {\n      setCorporateClients(corporateClientsData.corporateClients.items);\n    }\n\n    if (individualClientsData) {\n      setIndividualClients(individualClientsData.individualClients.items);\n    }\n  }, [corporateClientsData, individualClientsData]);\n  const [addContactPerson, {\n    loading\n  }] = useCallback(useMutation(ADD_NEW_CONTACT_PERSON, {\n    update(_, result) {\n      context.registerContactPerson(result.data);\n      setVisible(false);\n      const contactData = result.data.createContactPerson.contactPerson;\n      history.push({\n        pathname: `/staff/dashboard/contact-person/profile/${contactData.id}`,\n        state: {\n          user: contactData\n        }\n      });\n    },\n\n    onError(err) {\n      try {\n        console.log(err.graphQLErrors && err.graphQLErrors[0] ? err.graphQLErrors[0].message : err.networkError && err.networkError.result ? err.networkError.result.errors : err);\n\n        if (err.graphQLErrors) {\n          setResponseErrors(err.graphQLErrors[0].message);\n        }\n\n        if (err.networkError !== null && err.networkError !== 'undefined') {\n          setResponseErrors(err.networkError.result.errors[0]);\n        } else if (err.graphQLErrors !== null && err.networkError !== 'undefined') {\n          setResponseErrors(err.graphQLErrors.result.errors[0]);\n        }\n      } catch (e) {\n        setVisible(true);\n      }\n    },\n\n    variables: values\n  }));\n  const validate = useCallback(values => {\n    schema.validate(values, {\n      abortEarly: false\n    }).then(valid => setErrors({\n      errorPaths: [],\n      errors: []\n    })) //called if the entire form is valid\n    .catch(err => {\n      setErrors({\n        errors: err.errors,\n        errorPaths: err.inner.map(i => i.path)\n      });\n    });\n  }, [schema]);\n  useEffect(() => {\n    if (values.updated) {\n      setValues({ ...values,\n        updated: false\n      });\n\n      if (values.afterSubmit) {\n        validate(values);\n      }\n    }\n  }, [values, validate]);\n\n  const handleOnGenderChange = (e, {\n    value\n  }) => {\n    e.preventDefault();\n    setValues({ ...values,\n      gender: value,\n      updated: true\n    });\n  };\n\n  const handleOnClientSearch = e => {\n    setSearch({\n      search: e.target.value\n    });\n  };\n\n  const handleOnClientChange = (e, {\n    value\n  }) => {\n    e.preventDefault();\n    setValues({ ...values,\n      individualClients: value,\n      updated: true\n    });\n  };\n\n  const handleOnCorporateClientChange = (e, {\n    value\n  }) => {\n    e.preventDefault();\n    setValues({ ...values,\n      corporateClients: value,\n      updated: true\n    });\n  };\n\n  const onChange = useCallback((event, {\n    name,\n    value\n  }) => {\n    setValues({ ...values,\n      [name]: value,\n      updated: true\n    });\n  }, [values]);\n  const [visible, setVisible] = useState(false);\n\n  const handleDismiss = () => {\n    setVisible(false);\n    setSuccessMsg('');\n  };\n\n  const genderOptions = [{\n    key: 'F',\n    text: 'Female',\n    value: 'F'\n  }, {\n    key: 'M',\n    text: 'Male',\n    value: 'M'\n  }, {\n    key: 'O',\n    text: 'Other',\n    value: 'O'\n  }];\n  const onPhoneNumberChange = useCallback(value => {\n    setValues({ ...values,\n      phoneNumber: \"+\" + value,\n      updated: true\n    });\n  }, [values]);\n\n  const onSubmit = event => {\n    event.preventDefault();\n    setSuccessMsg('');\n    validate(values);\n    setValues({ ...values,\n      afterSubmit: true\n    });\n\n    if (Object.keys(values).length > 7 && !errors.errors.length) {\n      addContactPerson();\n    }\n\n    setVisible(false);\n    console.log(\"errors\", errors);\n  };\n\n  return /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    padded: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Grid.Column, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"content-wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    as: \"h2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Icon, {\n    name: \"settings\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 29\n    }\n  }), /*#__PURE__*/React.createElement(Header.Content, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    href: \"/staff/dashboard/contact-person-records\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 33\n    }\n  }, \"Contact Person Records\"), \" \", '>', \" Register Contact Person\", /*#__PURE__*/React.createElement(Header.Subheader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 17\n    }\n  }, \"Hello \", authContext.user.username, \", Fill in this form to register a new contact person\")))))), /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    padded: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Grid.Column, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 17\n    }\n  }, successMsg ? /*#__PURE__*/React.createElement(Message, {\n    positive: true,\n    onDismiss: handleDismiss,\n    header: \"status\",\n    content: successMsg,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 25\n    }\n  }) : '', /*#__PURE__*/React.createElement(Form, {\n    onSubmit: onSubmit,\n    noValidate: true,\n    className: loading ? \"loading\" : '',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Form.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Message, {\n    visible: !!errors.errors.length || visible,\n    warning: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Message.Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 33\n    }\n  }, \"Please correct the following issues:\"), !!responseErrors.length && /*#__PURE__*/React.createElement(Message, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 61\n    }\n  }, responseErrors), /*#__PURE__*/React.createElement(Message.List, {\n    items: errors.errors,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 34\n    }\n  }))), /*#__PURE__*/React.createElement(Form.Group, {\n    widths: \"equal\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('name'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 33\n    }\n  }, \"Name\"), /*#__PURE__*/React.createElement(Form.Input, {\n    fluid: true,\n    placeholder: \"Name\",\n    name: \"name\",\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(Form.Field, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 33\n    }\n  }, \"Postal Address\"), /*#__PURE__*/React.createElement(Form.Input, {\n    fluid: true,\n    placeholder: \"Post Address\",\n    name: \"postalAddress\",\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('serviceLine'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 33\n    }\n  }, \"Service Line\"), /*#__PURE__*/React.createElement(Form.Input, {\n    fluid: true,\n    placeholder: \"service Line\",\n    name: \"serviceLine\",\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 33\n    }\n  }))), /*#__PURE__*/React.createElement(Form.Group, {\n    widths: \"equal\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('position'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 33\n    }\n  }, \"Position\"), /*#__PURE__*/React.createElement(Form.Input, {\n    fluid: true,\n    placeholder: \"Position\",\n    name: \"position\",\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('phoneNumber'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(PhoneInput, {\n    inputExtraProps: {\n      name: \"phoneNumber\",\n      required: true,\n      autoFocus: true,\n      enableSearch: true\n    },\n    style: {\n      fontWeight: \"bold\"\n    },\n    name: \"phoneNumber\",\n    specialLabel: \"Phone Number *\",\n    country: \"ke\",\n    value: values.phoneNumber,\n    onChange: onPhoneNumberChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('town'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 33\n    }\n  }, \"Residence (Town)\"), /*#__PURE__*/React.createElement(Form.Input, {\n    fluid: true,\n    placeholder: \"Residence (Town)\",\n    name: \"town\",\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 33\n    }\n  }))), /*#__PURE__*/React.createElement(Form.Group, {\n    widths: \"equal\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 280,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Form.Field, {\n    error: errors.errorPaths.includes('corporateClients'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 33\n    }\n  }, \"Corporate Client\"), corporateClients && /*#__PURE__*/React.createElement(Clients, {\n    clients: corporateClients,\n    multiple: true,\n    handleOnClientSearch: handleOnClientSearch,\n    handleOnClientChange: handleOnCorporateClientChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 54\n    }\n  })), /*#__PURE__*/React.createElement(Form.Field, {\n    error: errors.errorPaths.includes('individualClients'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 33\n    }\n  }, \"Individual Client\"), individualClients && /*#__PURE__*/React.createElement(IndividualClients, {\n    clients: individualClients,\n    multiple: true,\n    handleOnClientSearch: handleOnClientSearch,\n    handleOnClientChange: handleOnClientChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 292,\n      columnNumber: 55\n    }\n  }))), /*#__PURE__*/React.createElement(Form.Group, {\n    widths: \"equal\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('email'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 33\n    }\n  }, \"Email Address\"), /*#__PURE__*/React.createElement(Form.Input, {\n    fluid: true,\n    placeholder: \"Email Address\",\n    name: \"email\",\n    type: \"email\",\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('gender'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 33\n    }\n  }, \"Gender\"), /*#__PURE__*/React.createElement(Dropdown, {\n    placeholder: \"Select Gender\",\n    fluid: true,\n    selection: true,\n    onChange: handleOnGenderChange,\n    options: genderOptions,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 33\n    }\n  })), /*#__PURE__*/React.createElement(Form.Field, {\n    required: true,\n    error: errors.errorPaths.includes('dateOfBirth'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 33\n    }\n  }, \"Date Of Birth\"), /*#__PURE__*/React.createElement(DateInput, {\n    name: \"dateOfBirth\",\n    placeholder: \"Date Of Birth\",\n    autoComplete: \"off\",\n    popupPosition: \"bottom left\",\n    value: values.dateOfBirth ? values.dateOfBirth : \"\",\n    iconPosition: \"left\",\n    dateFormat: \"YYYY-MM-DD\",\n    maxDate: moment(),\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 33\n    }\n  }))), /*#__PURE__*/React.createElement(Button, {\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 337,\n      columnNumber: 25\n    }\n  }, \"Register Contact Person\")))));\n}\n\nexport default AddNewContactPerson;","map":{"version":3,"sources":["/home/actserv/Documents/brooks_insurance_agency_software/brooks-insurance-front-end/src/components/contactPersons/addNewContactPerson.js"],"names":["useHistory","useMutation","useQuery","React","useState","useContext","useEffect","useCallback","Grid","Container","Header","Icon","Form","Message","Button","Dropdown","moment","DateInput","ContactPersonContext","Clients","IndividualClients","ADD_NEW_CONTACT_PERSON","GET_CORPORATE_CLIENTS","FETCH_CLIENTS_QUERY","yup","AuthContext","PhoneInput","AddNewContactPerson","props","authContext","history","errors","setErrors","errorPaths","context","successMsg","setSuccessMsg","corporateClients","setCorporateClients","individualClients","setIndividualClients","search","setSearch","responseErrors","setResponseErrors","values","setValues","updated","afterSubmit","schema","object","shape","email","string","required","name","phoneNumber","position","serviceLine","town","dateOfBirth","date","gender","data","corporateClientsData","variables","individualClientsData","items","addContactPerson","loading","update","_","result","registerContactPerson","setVisible","contactData","createContactPerson","contactPerson","push","pathname","id","state","user","onError","err","console","log","graphQLErrors","message","networkError","e","validate","abortEarly","then","valid","catch","inner","map","i","path","handleOnGenderChange","value","preventDefault","handleOnClientSearch","target","handleOnClientChange","handleOnCorporateClientChange","onChange","event","visible","handleDismiss","genderOptions","key","text","onPhoneNumberChange","onSubmit","Object","keys","length","username","includes","autoFocus","enableSearch","fontWeight"],"mappings":"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","sourcesContent":["import { useHistory } from 'react-router-dom';\nimport { useMutation, useQuery } from '@apollo/react-hooks';\nimport React, { useState, useContext, useEffect, useCallback } from 'react';\nimport {\n    Grid,\n    Container,\n    Header,\n    Icon,\n    Form,\n    Message,\n    Button,\n    Dropdown\n} from 'semantic-ui-react';\nimport moment from 'moment';\nimport { DateInput } from 'semantic-ui-calendar-react';\nimport { ContactPersonContext } from '../../context/contactPerson';\nimport Clients from '../contactPersons/listContacts';\nimport IndividualClients from '../policies/listClients';\nimport { ADD_NEW_CONTACT_PERSON } from './queries';\nimport { GET_CORPORATE_CLIENTS, FETCH_CLIENTS_QUERY } from '../clients/queries';\nimport * as yup from \"yup\";\nimport { AuthContext } from '../../context/auth';\nimport PhoneInput from 'react-phone-input-2';\n\nfunction AddNewContactPerson({ props }) {\n    const authContext = useContext(AuthContext);\n    let history = useHistory();\n\n    const [errors, setErrors] = useState({\n        errorPaths: [],\n        errors: []\n    });\n    const context = useContext(ContactPersonContext);\n    const [successMsg, setSuccessMsg] = useState();\n    const [corporateClients, setCorporateClients] = useState();\n    const [individualClients, setIndividualClients] = useState();\n    const [search, setSearch] = useState({ search: \"\" });\n    const [responseErrors, setResponseErrors] = useState([]);\n\n\n    const [values, setValues] = useState({\n        updated: true,\n        afterSubmit: false,\n        individualClients: [],\n        corporateClients: []\n    });\n    let schema = yup.object().shape({\n        email: yup.string().required(\"Please provide an email address\"),\n        name: yup.string().required(\"Please provide the name\"),\n        // client: yup.string().required(\"Please  select the client\"),\n        phoneNumber: yup.string().required(\"Please provide a phone number\"),\n        position: yup.string().required(\"Please provide the position\"),\n        serviceLine: yup.string().required(\"Please provide the service line\"),\n        town: yup.string().required(\"Please provide the town of residence\"),\n        dateOfBirth: yup.date().required(\"Please input the date of birth\"),\n        gender: yup.string().required(\"Please select the gender\"),\n    });\n\n\n    const { data: corporateClientsData } = useQuery(GET_CORPORATE_CLIENTS, {\n        variables: search\n    });\n    const { data: individualClientsData } = useQuery(FETCH_CLIENTS_QUERY, {\n        variables: search\n    });\n    useEffect(() => {\n\n        if (corporateClientsData) {\n            setCorporateClients(corporateClientsData.corporateClients.items);\n        }\n        if (individualClientsData) {\n            setIndividualClients(individualClientsData.individualClients.items);\n        }\n    }, [corporateClientsData, individualClientsData]);\n\n    const [addContactPerson, { loading }] = useCallback(useMutation(ADD_NEW_CONTACT_PERSON, {\n        update(_, result) {\n            context.registerContactPerson(result.data);\n            setVisible(false);\n            const contactData = result.data.createContactPerson.contactPerson\n            history.push({\n                pathname: `/staff/dashboard/contact-person/profile/${contactData.id}`,\n                state: { user: contactData }\n            })\n        },\n        onError(err) {\n            try {\n                console.log(err.graphQLErrors && err.graphQLErrors[0] ? err.graphQLErrors[0].message : err.networkError && err.networkError.result ? err.networkError.result.errors : err)\n\n                if (err.graphQLErrors) {\n                    setResponseErrors(err.graphQLErrors[0].message);\n                }\n\n                if (err.networkError !== null && err.networkError !== 'undefined') {\n\n                    setResponseErrors(err.networkError.result.errors[0]);\n\n                } else if (err.graphQLErrors !== null && err.networkError !== 'undefined') {\n\n                    setResponseErrors(err.graphQLErrors.result.errors[0]);\n\n                }\n            } catch (e) {\n                setVisible(true);\n            }\n\n        },\n        variables: values\n    }));\n\n    const validate = useCallback((values) => {\n        schema.validate(values, { abortEarly: false })\n            .then(valid => setErrors({ errorPaths: [], errors: [] })) //called if the entire form is valid\n            .catch(err => {\n                setErrors({ errors: err.errors, errorPaths: err.inner.map(i => i.path) })\n            })\n    }, [schema])\n\n    useEffect(() => {\n        if (values.updated) {\n            setValues({ ...values, updated: false })\n            if (values.afterSubmit) {\n                validate(values)\n            }\n        }\n    }, [values, validate])\n    const handleOnGenderChange = (e, { value }) => {\n        e.preventDefault()\n        setValues({ ...values, gender: value, updated: true });\n    }\n    const handleOnClientSearch = (e) => {\n        setSearch({ search: e.target.value });\n    }\n    const handleOnClientChange = (e, { value }) => {\n        e.preventDefault()\n        setValues({ ...values, individualClients: value, updated: true });\n    }\n    const handleOnCorporateClientChange = (e, { value }) => {\n        e.preventDefault()\n        setValues({ ...values, corporateClients: value, updated: true });\n    }\n\n    const onChange = useCallback((event, { name, value }) => {\n        setValues({ ...values, [name]: value, updated: true });\n    }, [values])\n    const [visible, setVisible] = useState(false);\n\n    const handleDismiss = () => {\n        setVisible(false);\n        setSuccessMsg('');\n    }\n    const genderOptions = [\n        {\n            key: 'F',\n            text: 'Female',\n            value: 'F',\n        },\n        {\n            key: 'M',\n            text: 'Male',\n            value: 'M',\n        },\n        {\n            key: 'O',\n            text: 'Other',\n            value: 'O',\n        }\n    ]\n    const onPhoneNumberChange = useCallback((value) => {\n        setValues({ ...values, phoneNumber: \"+\" + value, updated: true });\n    }, [values])\n\n    const onSubmit = (event) => {\n        event.preventDefault();\n        setSuccessMsg('');\n        validate(values)\n        setValues({ ...values, afterSubmit: true })\n        if (Object.keys(values).length > 7 && !errors.errors.length) { addContactPerson() }\n        setVisible(false);\n        console.log(\"errors\", errors)\n    }\n    return (\n        <Container>\n            <Grid container padded>\n                <Grid.Column>\n                    <div className=\"content-wrapper\">\n                        <Header as='h2'>\n                            <Icon name='settings' />\n                            <Header.Content>\n                                <a href=\"/staff/dashboard/contact-person-records\">Contact Person Records</a> {'>'} Register Contact Person\n                <Header.Subheader>\n                                    Hello {authContext.user.username}, Fill in this form to register a new contact person\n                </Header.Subheader>\n                            </Header.Content>\n                        </Header>\n                    </div>\n                </Grid.Column>\n            </Grid>\n\n            <Grid container padded>\n                <Grid.Column>\n                    {successMsg ?\n                        <Message\n                            positive\n                            onDismiss={handleDismiss}\n                            header='status'\n                            content={successMsg} /> :\n                        ''}\n\n                    <Form onSubmit={onSubmit} noValidate className={loading ? \"loading\" : ''}>\n                        <Form.Group>\n                            <Message visible={!!errors.errors.length || visible} warning>\n                                <Message.Header>Please correct the following issues:</Message.Header>\n                                {!!responseErrors.length && <Message>{responseErrors}</Message>}\n                                {<Message.List items={errors.errors} />}\n                            </Message>\n                        </Form.Group>\n                        <Form.Group widths='equal'>\n                            <Form.Field required error={errors.errorPaths.includes('name')}>\n                                <label>Name</label>\n                                <Form.Input fluid placeholder='Name'\n                                    name='name'\n                                    onChange={onChange}\n\n                                />\n                            </Form.Field>\n                            <Form.Field>\n                                <label>Postal Address</label>\n                                <Form.Input fluid placeholder='Post Address'\n                                    name='postalAddress'\n                                    onChange={onChange}\n                                />\n                            </Form.Field>\n                            <Form.Field required error={errors.errorPaths.includes('serviceLine')}>\n                                <label>Service Line</label>\n                                <Form.Input fluid placeholder='service Line'\n                                    name='serviceLine'\n                                    onChange={onChange}\n\n                                />\n                            </Form.Field>\n\n\n                        </Form.Group>\n                        <Form.Group widths='equal'>\n                            <Form.Field required error={errors.errorPaths.includes('position')}>\n                                <label>Position</label>\n                                <Form.Input fluid placeholder='Position'\n                                    name='position'\n                                    onChange={onChange}\n\n                                />\n                            </Form.Field>\n                            <Form.Field required error={errors.errorPaths.includes('phoneNumber')}>\n                                <PhoneInput\n                                    inputExtraProps={{\n                                        name: \"phoneNumber\",\n                                        required: true,\n                                        autoFocus: true,\n                                        enableSearch: true\n                                    }}\n                                    style={{ fontWeight: \"bold\" }}\n                                    name='phoneNumber'\n                                    specialLabel='Phone Number *'\n                                    country={\"ke\"}\n                                    value={values.phoneNumber}\n                                    onChange={onPhoneNumberChange}\n                                />\n                            </Form.Field>\n                            <Form.Field required error={errors.errorPaths.includes('town')}>\n                                <label>Residence (Town)</label>\n                                <Form.Input\n                                    fluid placeholder='Residence (Town)'\n                                    name='town'\n                                    onChange={onChange}\n\n                                />\n                            </Form.Field>\n                        </Form.Group>\n                        <Form.Group widths='equal'>\n                            <Form.Field error={errors.errorPaths.includes('corporateClients')}>\n                                <label>Corporate Client</label>\n                                {corporateClients && <Clients\n                                    clients={corporateClients}\n                                    multiple={true}\n                                    handleOnClientSearch={handleOnClientSearch}\n                                    handleOnClientChange={handleOnCorporateClientChange}\n                                />}\n                            </Form.Field>\n                            <Form.Field error={errors.errorPaths.includes('individualClients')}>\n                                <label>Individual Client</label>\n                                {individualClients && <IndividualClients\n                                    clients={individualClients}\n                                    multiple={true}\n                                    handleOnClientSearch={handleOnClientSearch}\n                                    handleOnClientChange={handleOnClientChange}\n                                />}\n                            </Form.Field>\n                        </Form.Group>\n                        <Form.Group widths='equal'>\n                            <Form.Field required error={errors.errorPaths.includes('email')}>\n                                <label>Email Address</label>\n                                <Form.Input fluid placeholder='Email Address'\n                                    name='email'\n                                    type=\"email\"\n                                    onChange={onChange}\n\n                                />\n                            </Form.Field>\n                            <Form.Field required error={errors.errorPaths.includes('gender')}>\n                                <label>Gender</label>\n                                <Dropdown\n                                    placeholder='Select Gender'\n                                    fluid\n                                    selection\n                                    onChange={handleOnGenderChange}\n                                    options={genderOptions}\n                                />\n                            </Form.Field>\n\n                            <Form.Field required error={errors.errorPaths.includes('dateOfBirth')}>\n                                <label>Date Of Birth</label>\n\n                                <DateInput\n                                    name=\"dateOfBirth\"\n                                    placeholder=\"Date Of Birth\"\n                                    autoComplete=\"off\"\n                                    popupPosition=\"bottom left\"\n                                    value={values.dateOfBirth ? values.dateOfBirth : \"\"}\n                                    iconPosition=\"left\"\n                                    dateFormat=\"YYYY-MM-DD\"\n                                    maxDate={moment()}\n                                    onChange={onChange}\n                                />\n                            </Form.Field>\n                        </Form.Group>\n                        <Button type='submit'>Register Contact Person</Button>\n\n                    </Form>\n                </Grid.Column>\n            </Grid>\n        </Container>\n    )\n}\n\nexport default AddNewContactPerson;"]},"metadata":{},"sourceType":"module"}