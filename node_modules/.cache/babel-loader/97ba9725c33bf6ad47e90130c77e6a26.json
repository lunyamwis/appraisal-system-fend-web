{"ast":null,"code":"var _jsxFileName = \"/home/actserv/Documents/brooks_insurance_agency_software/brooks-insurance-front-end/src/components/auth/login.js\";\nimport React, { useContext, useState } from 'react';\nimport { Button, Form } from 'semantic-ui-react';\nimport { Grid, Container, Header, Message } from 'semantic-ui-react';\nimport { Link } from 'react-router-dom';\nimport gql from 'graphql-tag';\nimport { useMutation } from '@apollo/react-hooks';\nimport { AuthContext } from '../../context/auth';\nimport '../root.scss';\n\nfunction Login(props) {\n  const [errors, setErrors] = useState({});\n  const context = useContext(AuthContext);\n  const [visible, setVisible] = useState(false);\n  let alert;\n\n  if (props.location.state) {\n    alert = props.location.state.systemAlert;\n  }\n\n  const [values, setValues] = useState({\n    username: \"\",\n    password: \"\"\n  });\n\n  const handleDismiss = () => {\n    setVisible(false);\n  };\n\n  const [loginUser, {\n    loading\n  }] = useMutation(LOGIN_USER, {\n    update(_, result) {\n      context.login(result.data); // console.log(\"response\", result.data);\n\n      props.history.push({\n        pathname: '/admin/dashboard',\n        state: {\n          userInfo: result.data\n        }\n      });\n    },\n\n    onError(err) {\n      try {\n        if (err.graphQLErrors) {\n          setErrors({\n            message: err.graphQLErrors[0].message\n          });\n        }\n\n        if (err.networkError !== null && err.networkError !== 'undefined') {\n          setErrors({\n            message: err.networkError.result.errors[0]\n          });\n        } else if (err.graphQLErrors !== null && err.networkError !== 'undefined') {\n          setErrors({\n            message: err.graphQLErrors.result.errors[0]\n          });\n        }\n      } catch (e) {}\n    },\n\n    variables: values\n  });\n\n  const onChange = event => {\n    setValues({ ...values,\n      [event.target.name]: event.target.value\n    });\n  };\n\n  const onSubmit = event => {\n    event.preventDefault(); // console.log(\"form values\",values)\n\n    setErrors({});\n    loginUser();\n    setVisible(true);\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \".app-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    padded: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Grid.Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Grid.Column, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    as: \"h1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 29\n    }\n  }, \"Sign In\"), alert && visible ? /*#__PURE__*/React.createElement(Message, {\n    onDismiss: handleDismiss,\n    header: \"System Response\",\n    content: alert,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 33\n    }\n  }) : '', /*#__PURE__*/React.createElement(\"div\", {\n    className: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 29\n    }\n  }, \"New to Brooks Agency?\", /*#__PURE__*/React.createElement(Link, {\n    to: \"/admin/register\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 29\n    }\n  }, \" Sign Up Here\")), /*#__PURE__*/React.createElement(Form, {\n    onSubmit: onSubmit,\n    noValidate: true,\n    className: loading ? \"loading\" : '',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Form.Field, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 37\n    }\n  }, \"Username\"), /*#__PURE__*/React.createElement(\"input\", {\n    placeholder: \"Username\",\n    name: \"username\",\n    value: values.username,\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 37\n    }\n  })), /*#__PURE__*/React.createElement(Form.Field, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 37\n    }\n  }, \"Password\"), /*#__PURE__*/React.createElement(\"input\", {\n    placeholder: \"Password\",\n    type: \"password\",\n    name: \"password\",\n    value: values.password,\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 37\n    }\n  })), /*#__PURE__*/React.createElement(Button, {\n    type: \"submit\",\n    secondary: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 33\n    }\n  }, \"Sign In\")), visible && Object.keys(errors).length ? /*#__PURE__*/React.createElement(Message, {\n    onDismiss: handleDismiss,\n    header: \"Failed!\",\n    warning: true,\n    content: errors ? errors.message : '',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 33\n    }\n  }) : '')))));\n}\n\nexport default Login;\nconst LOGIN_USER = gql`\nmutation tokenAuth(\n    $username: String!\n    $password: String!\n) {\n  tokenAuth (\n    username: $username\n    password: $password\n  ){\n    token\n    user {\n      id\n      username\n      email\n      firstName\n      isSuperuser\n      isActive\n      isStaff\n      image\n      phoneNumber\n      roles\n      agency {\n        id\n        name\n        officeLocation\n        imageUrl\n        agencyEmail\n        postalCode\n        boxNumber\n        isActive\n      }\n    }\n  }\n}\n`;","map":{"version":3,"sources":["/home/actserv/Documents/brooks_insurance_agency_software/brooks-insurance-front-end/src/components/auth/login.js"],"names":["React","useContext","useState","Button","Form","Grid","Container","Header","Message","Link","gql","useMutation","AuthContext","Login","props","errors","setErrors","context","visible","setVisible","alert","location","state","systemAlert","values","setValues","username","password","handleDismiss","loginUser","loading","LOGIN_USER","update","_","result","login","data","history","push","pathname","userInfo","onError","err","graphQLErrors","message","networkError","e","variables","onChange","event","target","name","value","onSubmit","preventDefault","Object","keys","length"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from 'react';\nimport { Button, Form } from 'semantic-ui-react';\nimport { Grid, Container, Header, Message } from 'semantic-ui-react';\nimport { Link } from 'react-router-dom';\n\nimport gql from 'graphql-tag';\nimport { useMutation } from '@apollo/react-hooks';\nimport { AuthContext } from '../../context/auth';\n\nimport '../root.scss';\n\nfunction Login(props) {\n    const [errors, setErrors] = useState({});\n    const context = useContext(AuthContext);\n    const [visible, setVisible] = useState(false);\n\n\n    let alert;\n\n    if (props.location.state) {\n        alert = props.location.state.systemAlert;\n    }\n\n    const [values, setValues] = useState({\n        username: \"\",\n        password: \"\",\n    });\n\n\n    const handleDismiss = () => {\n        setVisible(false)\n    }\n\n    const [loginUser, { loading }] = useMutation(LOGIN_USER, {\n        update(_, result) {\n            context.login(result.data);\n            // console.log(\"response\", result.data);\n            props.history.push({\n                pathname: '/admin/dashboard',\n                state: { userInfo: result.data }\n            })\n        },\n        onError(err) {\n            try {\n                if (err.graphQLErrors) {\n                    setErrors({message:err.graphQLErrors[0].message});\n                }\n\n                if (err.networkError !== null && err.networkError !== 'undefined') {\n\n                    setErrors({message:err.networkError.result.errors[0]});\n\n                } else if (err.graphQLErrors !== null && err.networkError !== 'undefined') {\n                    setErrors({message:err.graphQLErrors.result.errors[0]});\n\n                }\n            } catch (e) {}\n\n        },\n        variables: values\n    });\n\n    const onChange = (event) => {\n        setValues({ ...values, [event.target.name]: event.target.value });\n    }\n\n    const onSubmit = (event) => {\n        event.preventDefault();\n        // console.log(\"form values\",values)\n        setErrors({})\n        loginUser();\n        setVisible(true);\n    }\n\n    return (\n        <div className='.app-container'>\n            <Container>\n                <Grid padded>\n                    <Grid.Row>\n                        <Grid.Column>\n                            <Header as='h1'>Sign In</Header>\n                            {alert && visible ?\n                                <Message\n                                    onDismiss={handleDismiss}\n                                    header='System Response'\n                                    content={alert}\n                                />\n                                :\n                                ''\n                            }\n\n\n                            <div className='center'>\n                                New to Brooks Agency?\n                            <Link to=\"/admin/register\"> Sign Up Here</Link>\n                            </div>\n                            <Form onSubmit={onSubmit} noValidate className={loading ? \"loading\" : ''}>\n\n                                <Form.Field>\n                                    <label>Username</label>\n                                    <input\n                                        placeholder='Username'\n                                        name='username'\n                                        value={values.username}\n                                        onChange={onChange}\n\n                                    />\n                                </Form.Field>\n\n                                <Form.Field>\n                                    <label>Password</label>\n                                    <input\n                                        placeholder='Password'\n                                        type='password'\n                                        name='password'\n                                        value={values.password}\n                                        onChange={onChange}\n                                    />\n                                </Form.Field>\n\n                                <Button type='submit' secondary>Sign In</Button>\n                            </Form>\n\n                            {visible && Object.keys(errors).length ?\n                                <Message\n                                    onDismiss={handleDismiss}\n                                    header='Failed!'\n                                    warning\n                                    content={errors ? errors.message : ''}\n                                />\n                                :\n                                ''\n\n                            }\n                        </Grid.Column>\n                    </Grid.Row>\n                </Grid>\n            </Container>\n        </div>\n    );\n}\n\nexport default Login;\n\nconst LOGIN_USER = gql`\nmutation tokenAuth(\n    $username: String!\n    $password: String!\n) {\n  tokenAuth (\n    username: $username\n    password: $password\n  ){\n    token\n    user {\n      id\n      username\n      email\n      firstName\n      isSuperuser\n      isActive\n      isStaff\n      image\n      phoneNumber\n      roles\n      agency {\n        id\n        name\n        officeLocation\n        imageUrl\n        agencyEmail\n        postalCode\n        boxNumber\n        isActive\n      }\n    }\n  }\n}\n`\n"]},"metadata":{},"sourceType":"module"}